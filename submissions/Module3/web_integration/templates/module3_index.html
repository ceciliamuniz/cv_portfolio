{% extends 'base.html' %}
{% block title %}Module 3: Advanced Image Analysis | CV Portfolio{% endblock %}
{% block head %}
    <link rel="stylesheet" href="{{ url_for('module3.static', filename='css/module3.css') }}">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container-module3 {
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header-module3 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        .header-module3 h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header-module3 p { font-size: 1.2em; opacity: 0.9; }
        .nav-pills {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 30px;
            flex-wrap: wrap;
        }
        .nav-pill {
            padding: 15px 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            color: #333;
        }
        .nav-pill:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .content-module3 { padding: 40px; }
        .part-card {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
            transition: all 0.3s;
        }
        .part-card:hover {
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transform: translateX(5px);
        }
        .part-card h2 { color: #667eea; margin-bottom: 15px; font-size: 1.8em; }
        .part-card p { color: #666; line-height: 1.6; margin-bottom: 15px; }
        .part-card ul { list-style: none; padding-left: 0; }
        .part-card li { padding: 8px 0 8px 25px; position: relative; }
        .part-card li:before { content: "âœ“"; position: absolute; left: 0; color: #667eea; font-weight: bold; }
        .btn-primary { display: inline-block; padding: 12px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; border-radius: 50px; font-weight: 600; transition: all 0.3s; border: none; cursor: pointer; margin-top: 15px; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px; }
        .stat-box { background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .stat-box h3 { font-size: 2.5em; color: #667eea; margin-bottom: 10px; }
        .stat-box p { color: #666; font-size: 0.9em; }
    </style>
{% endblock %}
{% block content %}
    <div class="container-module3">
        <div class="header-module3">
            <h1>ðŸŽ¯ Module 3: Advanced Image Analysis</h1>
            <p>Gradient Computation, Edge/Corner Detection & Object Segmentation</p>
        </div>
        <div class="nav-pills">
            <a href="{{ url_for('module3.part1') }}" class="nav-pill">Part 1: Gradient & LoG</a>
            <a href="{{ url_for('module3.part2') }}" class="nav-pill">Part 2: Keypoints</a>
            <a href="{{ url_for('module3.part3') }}" class="nav-pill">Part 3: Boundaries</a>
            <a href="{{ url_for('module3.part4_aruco') }}" class="nav-pill">Part 4: ArUco Segmentation</a>
            <a href="{{ url_for('module3.part5_sam2') }}" class="nav-pill">Part 5: SAM2 Comparison</a>
            <a href="{{ url_for('module3.gallery') }}" class="nav-pill">ðŸ“¸ Gallery</a>
        </div>
        <div class="content-module3">
            <div class="part-card">
                <h2>Part 1: Gradient Images & Laplacian of Gaussian</h2>
                <p>Compute gradient magnitude and angle using Sobel operators, and compare with Laplacian of Gaussian for edge detection.</p>
                <ul>
                    <li>Sobel-based gradient computation (magnitude & angle)</li>
                    <li>Laplacian of Gaussian (LoG) for multi-scale edge detection</li>
                    <li>Side-by-side comparison visualizations</li>
                </ul>
                <a href="{{ url_for('module3.part1') }}" class="btn-primary">View Results â†’</a>
            </div>
            
            <div class="part-card">
                <h2>Part 2: Edge & Corner Keypoint Detection</h2>
                <p>Implement Canny edge detection and Harris corner detection algorithms based on lecture principles.</p>
                <ul>
                    <li>Canny edge detection (Gaussian blur â†’ gradient â†’ NMS â†’ thresholding â†’ hysteresis)</li>
                    <li>Harris corner detection (structure tensor â†’ corner response â†’ NMS)</li>
                    <li>Combined keypoint visualization</li>
                </ul>
                <a href="{{ url_for('module3.part2') }}" class="btn-primary">View Results â†’</a>
            </div>
            
            <div class="part-card">
                <h2>Part 3: Object Boundary Detection</h2>
                <p>Detect exact boundaries of objects using classical computer vision techniques without ML/DL.</p>
                <ul>
                    <li>Contour detection using Canny edges</li>
                    <li>Convex hull fitting</li>
                    <li>Bounding rectangle computation</li>
                    <li>Multiple boundary representations</li>
                </ul>
                <a href="{{ url_for('module3.part3') }}" class="btn-primary">View Results â†’</a>
            </div>
            
            <div class="part-card">
                <h2>Part 4: ArUco Marker-Based Segmentation</h2>
                <p>Segment non-rectangular objects using ArUco markers placed on object boundaries.</p>
                <ul>
                    <li>ArUco marker detection (DICT_4X4_50)</li>
                    <li>Multiple segmentation methods (convex hull, contour, alpha-shape)</li>
                    <li>10+ images from various distances and angles</li>
                    <li>Classical CV approach without deep learning</li>
                </ul>
                <a href="{{ url_for('module3.part4_aruco') }}" class="btn-primary">Try It â†’</a>
            </div>
            
            <div class="part-card">
                <h2>Part 5: SAM2 Model Comparison</h2>
                <p>Compare ArUco-based segmentation with Meta's Segment Anything Model 2 (SAM2).</p>
                <ul>
                    <li>SAM2 segmentation using ArUco points as prompts</li>
                    <li>Quantitative comparison (IoU, Dice, Precision, Recall)</li>
                    <li>Visual overlap analysis</li>
                    <li>Classical CV vs. Deep Learning trade-offs</li>
                </ul>
                <a href="{{ url_for('module3.part5_sam2') }}" class="btn-primary">Compare â†’</a>
            </div>
            
            <div class="stats-grid">
                <div class="stat-box">
                    <h3 id="stat-images">10</h3>
                    <p>Images Processed</p>
                </div>
                <div class="stat-box">
                    <h3 id="stat-edges">424K+</h3>
                    <p>Edge Keypoints</p>
                </div>
                <div class="stat-box">
                    <h3 id="stat-corners">85K+</h3>
                    <p>Corner Keypoints</p>
                </div>
                <div class="stat-box">
                    <h3 id="stat-contours">252</h3>
                    <p>Contours Detected</p>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    <script>
        // Load stats from API
        fetch('/module3/api/stats')
            .then(response => response.json())
            .then(data => {
                document.getElementById('stat-images').textContent = data.part1_processed;
                document.getElementById('stat-edges').textContent = (data.part2_edge_keypoints / 1000).toFixed(0) + 'K+';
                document.getElementById('stat-corners').textContent = (data.part2_corner_keypoints / 1000).toFixed(0) + 'K+';
                document.getElementById('stat-contours').textContent = data.part3_contours;
            })
            .catch(err => console.error('Failed to load stats:', err));
    </script>
{% endblock %}
